(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{189:function(l,v,_){"use strict";_.r(v);var i=_(0),n=Object(i.a)({},(function(){var l=this,v=l.$createElement,_=l._self._c||v;return _("ContentSlotsDistributor",{attrs:{"slot-key":l.$parent.slotKey}},[_("div",{staticClass:"custom-block tip"},[_("p",{staticClass:"custom-block-title"},[l._v("提示")]),l._v(" "),_("p",[l._v("源自：https://blog.csdn.net/m0_37989980/article/details/103413942")])]),l._v(" "),_("ol",[_("li",[_("p",[l._v("事务的基本介绍")]),l._v(" "),_("ol",[_("li",[_("p",[l._v("概念：")]),l._v(" "),_("ul",[_("li",[l._v("如果一个包含多个步骤的业务操作，被事务管理，那么这些操作要么同时成功，要么同时失败。")])])]),l._v(" "),_("li",[_("p",[l._v("操作：")]),l._v(" "),_("ol",[_("li",[l._v("开启事务： start transaction;")]),l._v(" "),_("li",[l._v("回滚：rollback;")]),l._v(" "),_("li",[l._v("提交：commit;")])])]),l._v(" "),_("li",[_("p",[l._v("例子：\nCREATE TABLE account (\nid INT PRIMARY KEY AUTO_INCREMENT,\nNAME VARCHAR(10),\nbalance DOUBLE\n);\n-- 添加数据\nINSERT INTO account (NAME, balance) VALUES ('zhangsan', 1000), ('lisi', 1000);")]),l._v(" "),_("p",[l._v("SELECT * FROM account;\nUPDATE account SET balance = 1000;\n-- 张三给李四转账 500 元")]),l._v(" "),_("p",[l._v("-- 0. 开启事务\nSTART TRANSACTION;\n-- 1. 张三账户 -500")]),l._v(" "),_("p",[l._v("UPDATE account SET balance = balance - 500 WHERE NAME = 'zhangsan';\n-- 2. 李四账户 +500\n-- 出错了...\nUPDATE account SET balance = balance + 500 WHERE NAME = 'lisi';")]),l._v(" "),_("p",[l._v("-- 发现执行没有问题，提交事务\nCOMMIT;")]),l._v(" "),_("p",[l._v("-- 发现出问题了，回滚事务\nROLLBACK;")])]),l._v(" "),_("li",[_("p",[l._v("MySQL数据库中事务默认自动提交")]),l._v(" "),_("ul",[_("li",[l._v("事务提交的两种方式：\n"),_("ul",[_("li",[l._v("自动提交：\n"),_("ul",[_("li",[l._v("mysql就是自动提交的")]),l._v(" "),_("li",[l._v("一条DML(增删改)语句会自动提交一次事务。")])])]),l._v(" "),_("li",[l._v("手动提交：\n"),_("ul",[_("li",[l._v("Oracle 数据库默认是手动提交事务")]),l._v(" "),_("li",[l._v("需要先开启事务，再提交")])])])])]),l._v(" "),_("li",[l._v("修改事务的默认提交方式：\n"),_("ul",[_("li",[l._v("查看事务的默认提交方式：SELECT @@autocommit; -- 1 代表自动提交  0 代表手动提交")]),l._v(" "),_("li",[l._v("修改默认提交方式： set @@autocommit = 0;")])])])])])])]),l._v(" "),_("li",[_("p",[l._v("事务的四大特征：")]),l._v(" "),_("ol",[_("li",[l._v("原子性：是不可分割的最小操作单位，要么同时成功，要么同时失败。")]),l._v(" "),_("li",[l._v("持久性：当事务提交或回滚后，数据库会持久化的保存数据。")]),l._v(" "),_("li",[l._v("隔离性：多个事务之间。相互独立。")]),l._v(" "),_("li",[l._v("一致性：事务操作前后，数据总量不变")])])]),l._v(" "),_("li",[_("p",[l._v("事务的隔离级别（了解）")]),l._v(" "),_("ul",[_("li",[_("p",[l._v("概念：多个事务之间隔离的，相互独立的。但是如果多个事务操作同一批数据，则会引发一些问题，设置不同的隔离级别就可以解决这些问题。")])]),l._v(" "),_("li",[_("p",[l._v("存在问题：")]),l._v(" "),_("ol",[_("li",[l._v("脏读：一个事务，读取到另一个事务中没有提交的数据")]),l._v(" "),_("li",[l._v("不可重复读(虚读)：在同一个事务中，两次读取到的数据不一样。")]),l._v(" "),_("li",[l._v("幻读：一个事务操作(DML)数据表中所有记录，另一个事务添加了一条数据，则第一个事务查询不到自己的修改。")])])]),l._v(" "),_("li",[_("p",[l._v("隔离级别：")]),l._v(" "),_("ol",[_("li",[l._v("read uncommitted：读未提交\n"),_("ul",[_("li",[l._v("产生的问题：脏读、不可重复读、幻读")])])]),l._v(" "),_("li",[l._v("read committed：读已提交 （Oracle）\n"),_("ul",[_("li",[l._v("产生的问题：不可重复读、幻读")])])]),l._v(" "),_("li",[l._v("repeatable read：可重复读 （MySQL默认）\n"),_("ul",[_("li",[l._v("产生的问题：幻读")])])]),l._v(" "),_("li",[l._v("serializable：串行化\n"),_("ul",[_("li",[l._v("可以解决所有的问题")])])])]),l._v(" "),_("ul",[_("li",[l._v("注意：隔离级别从小到大安全性越来越高，但是效率越来越低")]),l._v(" "),_("li",[l._v("数据库查询隔离级别：\n"),_("ul",[_("li",[l._v("select @@tx_isolation;")])])]),l._v(" "),_("li",[l._v("数据库设置隔离级别：\n"),_("ul",[_("li",[l._v("set global transaction isolation level  级别字符串;")])])])])]),l._v(" "),_("li",[_("p",[l._v("演示：\nset global transaction isolation level read uncommitted;\nstart transaction;\n-- 转账操作\nupdate account set balance = balance - 500 where id = 1;\nupdate account set balance = balance + 500 where id = 2;")])])])])])])}),[],!1,null,null,null);v.default=n.exports}}]);